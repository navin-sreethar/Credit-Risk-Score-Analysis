<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Credit Score Simulator</title>
    <link rel="stylesheet" href="css/credit-factors.css">
    <link rel="stylesheet" href="css/visual-enhancements.css">
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            color: #333;
            max-width: 1000px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f5f5f5;
        }
        h1 {
            color: #2c3e50;
            text-align: center;
            margin-bottom: 15px;
        }
        
        .intro-text {
            text-align: center;
            color: #7f8c8d;
            margin-bottom: 30px;
            padding: 0 40px;
        }
        .welcome-banner {
            background: linear-gradient(135deg, #3498db, #2980b9);
            color: white;
            padding: 20px;
            border-radius: 8px;
            margin: 20px auto;
            text-align: left;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
            max-width: 800px;
        }
        .welcome-banner h3 {
            margin-top: 0;
            color: white;
        }
        .banner-tips {
            display: flex;
            justify-content: space-around;
            margin-top: 20px;
        }
        .tip-item {
            display: flex;
            align-items: center;
        }
        .tip-icon {
            font-size: 24px;
            margin-right: 10px;
        }
        .tip-text {
            font-weight: 500;
        }
        .container {
            background-color: white;
            border-radius: 8px;
            padding: 30px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }
        .form-group {
            margin-bottom: 15px;
        }
        label {
            display: block;
            margin-bottom: 5px;
            font-weight: 500;
        }
        input[type="number"], select {
            width: 100%;
            padding: 8px;
            border: 1px solid #ddd;
            border-radius: 4px;
            box-sizing: border-box;
        }
        .section-desc {
            color: #7f8c8d;
            font-size: 14px;
            margin-top: -5px;
            margin-bottom: 15px;
        }
        .help-text {
            color: #7f8c8d;
            font-size: 12px;
            display: block;
            margin-top: 5px;
        }
        .info-tooltip {
            position: relative;
            display: inline-block;
            margin-bottom: 15px;
        }
        .info-icon {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            width: 20px;
            height: 20px;
            border-radius: 50%;
            background-color: #3498db;
            color: white;
            font-size: 12px;
            font-style: normal;
            cursor: pointer;
        }
        .tooltip-content {
            display: none;
            position: absolute;
            bottom: 100%;
            left: 0;
            width: 280px;
            background-color: white;
            border-radius: 6px;
            box-shadow: 0 3px 10px rgba(0, 0, 0, 0.2);
            padding: 10px 15px;
            z-index: 10;
        }
        .tooltip-content ul {
            margin: 5px 0;
            padding-left: 20px;
        }
        .tooltip-content li {
            margin-bottom: 3px;
        }
        .info-tooltip:hover .tooltip-content {
            display: block;
        }
        .warning-message {
            background-color: #fcf8e3;
            border: 1px solid #faebcc;
            color: #8a6d3b;
            padding: 10px;
            margin: 15px 0;
            border-radius: 4px;
            animation: fadeIn 0.3s ease-in;
        }
        .important-badge {
            display: inline-block;
            background-color: #e74c3c;
            color: white;
            font-size: 12px;
            padding: 3px 8px;
            border-radius: 12px;
            margin-left: 10px;
            font-weight: bold;
            animation: pulse 2s infinite;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }
        .section-title {
            color: #3498db;
            border-bottom: 1px solid #eee;
            padding-bottom: 8px;
            margin-bottom: 10px;
        }
        .row {
            display: flex;
            flex-wrap: wrap;
            margin: 0 -10px;
        }
        .col {
            flex: 1;
            padding: 0 10px;
            min-width: 200px;
        }
        button {
            background-color: #3498db;
            color: white;
            border: none;
            padding: 10px 20px;
            font-size: 16px;
            border-radius: 4px;
            cursor: pointer;
            width: 100%;
            margin-top: 15px;
        }
        button:hover {
            background-color: #2980b9;
        }
        .section {
            margin-bottom: 25px;
            padding-bottom: 15px;
            border-bottom: 1px solid #eee;
        }
        .section-title {
            color: #3498db;
            margin-bottom: 15px;
        }
        .result {
            display: none;
            margin-top: 30px;
            padding: 20px;
            border-radius: 8px;
            background-color: #f8f9fa;
            border-left: 5px solid #3498db;
        }
        .result h2 {
            margin-top: 0;
            color: #2c3e50;
        }
        .risk-high {
            border-left-color: #e74c3c;
        }
        .risk-medium {
            border-left-color: #f39c12;
        }
        .risk-low {
            border-left-color: #2ecc71;
        }
        
        /* Result container styling */
        .result {
            padding: 25px !important;
        }
        
        /* Score display */
        .score-container {
            display: flex;
            align-items: center;
            margin-bottom: 25px;
            padding-bottom: 20px;
            border-bottom: 1px solid #eee;
        }
        
        .score-circle {
            width: 120px;
            height: 120px;
            border-radius: 50%;
            background: linear-gradient(135deg, #3498db, #2ecc71);
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 36px;
            font-weight: bold;
            margin-right: 25px;
            box-shadow: 0 4px 10px rgba(0,0,0,0.1);
        }
        
        .score-details {
            flex: 1;
        }
        
        .score-details h3 {
            margin-top: 0;
            color: #2c3e50;
            font-size: 24px;
        }
        
        .score-explanation {
            color: #7f8c8d;
            margin-bottom: 0;
        }
        
        /* Credit summary section */
        .credit-summary {
            display: flex;
            margin-bottom: 25px;
            gap: 20px;
        }
        
        .summary-card {
            flex: 1;
            background-color: #f8f9fa;
            padding: 15px;
            border-radius: 8px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.05);
        }
        
        .summary-card h4 {
            margin-top: 0;
            color: #3498db;
            font-size: 16px;
        }
        
        /* Score range visualization */
        .score-range-container {
            margin-bottom: 25px;
            padding-bottom: 20px;
            border-bottom: 1px solid #eee;
        }
        
        .score-range {
            display: flex;
            height: 60px;
            border-radius: 8px;
            overflow: hidden;
            margin: 15px 0 5px 0;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }
        
        .range-segment {
            flex: 1;
            display: flex;
            flex-direction: column;
            justify-content: center;
            padding: 10px;
            color: white;
            text-align: center;
        }
        
        .range-label {
            font-weight: bold;
            font-size: 16px;
        }
        
        .range-value {
            font-size: 12px;
            opacity: 0.9;
        }
        
        .poor {
            background-color: #e74c3c;
        }
        
        .fair {
            background-color: #f39c12;
        }
        
        .good {
            background-color: #3498db;
        }
        
        .excellent {
            background-color: #2ecc71;
        }
        
        #score-pointer {
            width: 0;
            height: 0;
            border-left: 10px solid transparent;
            border-right: 10px solid transparent;
            border-top: 10px solid #2c3e50;
            margin-left: 0;
            transition: margin-left 0.5s ease-in-out;
        }
        
        /* Factors affecting score */
        .factors-container {
            background-color: #f8f9fa;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.05);
            margin-top: 25px;
        }
        
        /* Loan approval styling */
        .loan-approval-section {
            margin: 25px 0;
            padding: 20px;
            background-color: #f8f9fa;
            border-radius: 8px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.05);
        }
        
        .loan-cards-container {
            display: flex;
            flex-wrap: wrap;
            gap: 15px;
            margin-top: 20px;
            margin-bottom: 15px;
        }
        
        .loan-card {
            flex: 1;
            min-width: 200px;
            padding: 15px;
            border-radius: 8px;
            background-color: white;
            box-shadow: 0 2px 4px rgba(0,0,0,0.05);
            border-left: 5px solid #ccc;
            position: relative;
        }
        
        .loan-card h4 {
            margin-top: 0;
            margin-bottom: 15px;
            color: #2c3e50;
        }
        
        .approval-label {
            font-weight: bold;
            margin-bottom: 5px;
        }
        
        .approval-high {
            color: #2ecc71;
        }
        
        .approval-medium {
            color: #f39c12;
        }
        
        .approval-low {
            color: #e74c3c;
        }
        
        .loan-card.high-chance {
            border-left-color: #2ecc71;
        }
        
        .loan-card.medium-chance {
            border-left-color: #f39c12;
        }
        
        .loan-card.low-chance {
            border-left-color: #e74c3c;
        }
        
        .loan-badge {
            position: absolute;
            top: 15px;
            right: 15px;
            padding: 3px 8px;
            border-radius: 12px;
            font-size: 12px;
            font-weight: bold;
            color: white;
        }
        
        .approved-badge {
            background-color: #2ecc71;
        }
        
        .declined-badge {
            background-color: #e74c3c;
        }
        
        .loan-legend {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin-top: 10px;
        }
        
        .legend-item {
            display: flex;
            align-items: center;
            font-size: 12px;
            color: #7f8c8d;
        }
        
        .legend-color {
            width: 15px;
            height: 15px;
            display: inline-block;
            margin-right: 5px;
            border-radius: 3px;
        }
        
        .high-approval {
            background-color: #2ecc71;
        }
        
        .medium-approval {
            background-color: #f39c12;
        }
        
        .low-approval {
            background-color: #e74c3c;
        }
        
        .factors-container h3 {
            margin-top: 0;
            color: #2c3e50;
        }
        
        .help-text {
            color: #7f8c8d;
            font-size: 14px;
            margin-bottom: 15px;
        }
        
        #factorsList li {
            margin-bottom: 10px;
            padding-bottom: 10px;
            border-bottom: 1px solid #eee;
        }
        
        .improvement-tips {
            margin-top: 20px;
            padding-top: 15px;
            border-top: 1px dashed #ddd;
        }
        
        .improvement-tips h4 {
            color: #3498db;
        }
        
        .factor-high {
            color: #e74c3c;
            font-weight: bold;
        }
        
        .factor-medium {
            color: #f39c12;
        }
        
        .factor-low {
            color: #3498db;
        }
        
        .loading {
            display: none;
            text-align: center;
            margin-top: 20px;
        }
        .loading-spinner {
            display: inline-block;
            width: 50px;
            height: 50px;
            border: 3px solid rgba(0, 0, 0, 0.1);
            border-radius: 50%;
            border-top-color: #3498db;
            animation: spin 1s ease-in-out infinite;
        }
        @keyframes spin {
            to { transform: rotate(360deg); }
        }
        .error {
            display: none;
            color: #e74c3c;
            background-color: #fadbd8;
            padding: 15px;
            border-radius: 4px;
            margin-top: 20px;
        }
    </style>
</head>
<body>
        <div class="container">
        <h1>Credit Score Simulator</h1>
        <div class="intro-text">
            <p>This tool helps you understand how different financial behaviors impact your credit score. 
            Enter your information below to get a detailed credit risk assessment with personalized improvement tips.</p>
            <div class="welcome-banner">
                <h3>Why Your Credit Score Matters</h3>
                <p>Your credit score influences your ability to get loans, credit cards, and even affects interest rates and rental applications.
                Understanding how it's calculated helps you make better financial decisions.</p>
                <div class="banner-tips">
                    <div class="tip-item">
                        <div class="tip-icon">üí∞</div>
                        <div class="tip-text">Lower interest rates</div>
                    </div>
                    <div class="tip-item">
                        <div class="tip-icon">üè†</div>
                        <div class="tip-text">Better loan terms</div>
                    </div>
                    <div class="tip-item">
                        <div class="tip-icon">üìä</div>
                        <div class="tip-text">Higher credit limits</div>
                    </div>
                </div>
            </div>
        </div>
        
        <form id="creditForm">
                    <div class="section">
                        <h3 class="section-title">Personal Information</h3>
                        <p class="section-desc">Basic information about you</p>
                        
                        <div class="row">
                            <div class="col">
                                <div class="form-group important-field">
                                    <label for="LIMIT_BAL">Credit Limit ($)</label>
                                    <input type="number" id="LIMIT_BAL" name="LIMIT_BAL" required value="200000">
                                    <span class="help-text">One of the most important factors in your score</span>
                                </div>
                            </div>
                            <div class="col">
                                <div class="form-group">
                                    <label for="SEX">Gender</label>
                                    <select id="SEX" name="SEX" required>
                                        <option value="1">Male</option>
                                        <option value="2" selected>Female</option>
                                    </select>
                                </div>
                            </div>
                        </div>
                        
                        <div class="row">
                            <div class="col">
                                <div class="form-group">
                                    <label for="EDUCATION">Education Level</label>
                                    <select id="EDUCATION" name="EDUCATION" required>
                                        <option value="1">Graduate School</option>
                                        <option value="2" selected>University</option>
                                        <option value="3">High School</option>
                                        <option value="4">Other</option>
                                    </select>
                                </div>
                            </div>
                            <div class="col">
                                <div class="form-group">
                                    <label for="MARRIAGE">Marital Status</label>
                                    <select id="MARRIAGE" name="MARRIAGE" required>
                                        <option value="1" selected>Married</option>
                                        <option value="2">Single</option>
                                        <option value="3">Other</option>
                                    </select>
                                </div>
                            </div>
                            <div class="col">
                                <div class="form-group">
                                    <label for="AGE">Age</label>
                                    <input type="number" id="AGE" name="AGE" required value="35" min="18" max="100">
                                </div>
                            </div>
                        </div>
                    </div>            <div class="section">
                <h3 class="section-title">Payment History (Last 6 Months)</h3>
                <p class="section-desc">Your payment status for each month <span class="important-badge">Very Important for Score</span></p>
                <div class="info-tooltip">
                    <i class="info-icon">i</i>
                    <div class="tooltip-content">
                        <div class="tooltip-title">About Payment Status Values</div>
                        <p>These values reflect your payment behavior:</p>
                        <ul>
                            <li><strong>-2:</strong> No consumption (no bill this month)</li>
                            <li><strong>-1:</strong> Paid in full (excellent)</li>
                            <li><strong>0:</strong> Revolving credit (paid minimum)</li>
                            <li><strong>1-9:</strong> Delay of 1-9 months (negative impact)</li>
                        </ul>
                        <p>Having values above 0 indicates late payments and significantly lowers your credit score.</p>
                        <div class="tooltip-arrow"></div>
                    </div>
                </div>
                <div class="row">
                    <div class="col">
                        <div class="form-group">
                            <label for="PAY_0">September Payment</label>
                            <select id="PAY_0" name="PAY_0" required>
                                <option value="-2">No consumption</option>
                                <option value="-1">Paid in full</option>
                                <option value="0" selected>Revolving credit</option>
                                <option value="1">1 month late</option>
                                <option value="2">2 months late</option>
                                <option value="3">3 months late</option>
                                <option value="4">4+ months late</option>
                            </select>
                        </div>
                    </div>
                    <div class="col">
                        <div class="form-group">
                            <label for="PAY_2">August Payment</label>
                            <select id="PAY_2" name="PAY_2" required>
                                <option value="-2">No consumption</option>
                                <option value="-1">Paid in full</option>
                                <option value="0" selected>Revolving credit</option>
                                <option value="1">1 month late</option>
                                <option value="2">2 months late</option>
                                <option value="3">3 months late</option>
                                <option value="4">4+ months late</option>
                            </select>
                        </div>
                    </div>
                    <div class="col">
                        <div class="form-group">
                            <label for="PAY_3">July Payment</label>
                            <select id="PAY_3" name="PAY_3" required>
                                <option value="-2">No consumption</option>
                                <option value="-1">Paid in full</option>
                                <option value="0" selected>Revolving credit</option>
                                <option value="1">1 month late</option>
                                <option value="2">2 months late</option>
                                <option value="3">3 months late</option>
                                <option value="4">4+ months late</option>
                            </select>
                        </div>
                    </div>
                </div>
                <div class="row">
                    <div class="col">
                        <div class="form-group">
                            <label for="PAY_4">June Payment</label>
                            <select id="PAY_4" name="PAY_4" required>
                                <option value="-2">No consumption</option>
                                <option value="-1">Paid in full</option>
                                <option value="0" selected>Revolving credit</option>
                                <option value="1">1 month late</option>
                                <option value="2">2 months late</option>
                                <option value="3">3 months late</option>
                                <option value="4">4+ months late</option>
                            </select>
                        </div>
                    </div>
                    <div class="col">
                        <div class="form-group">
                            <label for="PAY_5">May Payment</label>
                            <select id="PAY_5" name="PAY_5" required>
                                <option value="-2">No consumption</option>
                                <option value="-1">Paid in full</option>
                                <option value="0" selected>Revolving credit</option>
                                <option value="1">1 month late</option>
                                <option value="2">2 months late</option>
                                <option value="3">3 months late</option>
                                <option value="4">4+ months late</option>
                            </select>
                        </div>
                    </div>
                    <div class="col">
                        <div class="form-group">
                            <label for="PAY_6">April Payment</label>
                            <select id="PAY_6" name="PAY_6" required>
                                <option value="-2">No consumption</option>
                                <option value="-1">Paid in full</option>
                                <option value="0" selected>Revolving credit</option>
                                <option value="1">1 month late</option>
                                <option value="2">2 months late</option>
                                <option value="3">3 months late</option>
                                <option value="4">4+ months late</option>
                            </select>
                        </div>
                    </div>
                </div>
            </div>

            <div class="section">
                <h3 class="section-title">Bill Amounts ($)</h3>
                <p class="section-desc">Your statement balance for each month</p>
                <div class="row">
                    <div class="col">
                        <div class="form-group">
                            <label for="BILL_AMT1">September Bill</label>
                            <input type="number" id="BILL_AMT1" name="BILL_AMT1" required value="30000">
                            <small class="help-text">Total amount due on statement</small>
                        </div>
                    </div>
                    <div class="col">
                        <div class="form-group">
                            <label for="BILL_AMT2">August Bill</label>
                            <input type="number" id="BILL_AMT2" name="BILL_AMT2" required value="28000">
                            <small class="help-text">Total amount due on statement</small>
                        </div>
                    </div>
                    <div class="col">
                        <div class="form-group">
                            <label for="BILL_AMT3">July Bill</label>
                            <input type="number" id="BILL_AMT3" name="BILL_AMT3" required value="25000">
                            <small class="help-text">Total amount due on statement</small>
                        </div>
                    </div>
                </div>
                <div class="row">
                    <div class="col">
                        <div class="form-group">
                            <label for="BILL_AMT4">June Bill</label>
                            <input type="number" id="BILL_AMT4" name="BILL_AMT4" required value="23000">
                            <small class="help-text">Total amount due on statement</small>
                        </div>
                    </div>
                    <div class="col">
                        <div class="form-group">
                            <label for="BILL_AMT5">May Bill</label>
                            <input type="number" id="BILL_AMT5" name="BILL_AMT5" required value="21000">
                            <small class="help-text">Total amount due on statement</small>
                        </div>
                    </div>
                    <div class="col">
                        <div class="form-group">
                            <label for="BILL_AMT6">April Bill</label>
                            <input type="number" id="BILL_AMT6" name="BILL_AMT6" required value="20000">
                            <small class="help-text">Total amount due on statement</small>
                        </div>
                    </div>
                </div>
            </div>

            <div class="section">
                <h3 class="section-title">Payment Amounts ($)</h3>
                <p class="section-desc">How much you paid toward each month's bill</p>
                <div class="row">
                    <div class="col">
                        <div class="form-group">
                            <label for="PAY_AMT1">September Payment</label>
                            <input type="number" id="PAY_AMT1" name="PAY_AMT1" required value="5000">
                            <small class="help-text">Amount you paid toward bill</small>
                        </div>
                    </div>
                    <div class="col">
                        <div class="form-group">
                            <label for="PAY_AMT2">August Payment</label>
                            <input type="number" id="PAY_AMT2" name="PAY_AMT2" required value="5000">
                            <small class="help-text">Amount you paid toward bill</small>
                        </div>
                    </div>
                    <div class="col">
                        <div class="form-group">
                            <label for="PAY_AMT3">July Payment</label>
                            <input type="number" id="PAY_AMT3" name="PAY_AMT3" required value="5000">
                            <small class="help-text">Amount you paid toward bill</small>
                        </div>
                    </div>
                </div>
                <div class="row">
                    <div class="col">
                        <div class="form-group">
                            <label for="PAY_AMT4">June Payment</label>
                            <input type="number" id="PAY_AMT4" name="PAY_AMT4" required value="5000">
                            <small class="help-text">Amount you paid toward bill</small>
                        </div>
                    </div>
                    <div class="col">
                        <div class="form-group">
                            <label for="PAY_AMT5">May Payment</label>
                            <input type="number" id="PAY_AMT5" name="PAY_AMT5" required value="5000">
                            <small class="help-text">Amount you paid toward bill</small>
                        </div>
                    </div>
                    <div class="col">
                        <div class="form-group">
                            <label for="PAY_AMT6">April Payment</label>
                            <input type="number" id="PAY_AMT6" name="PAY_AMT6" required value="5000">
                            <small class="help-text">Amount you paid toward bill</small>
                        </div>
                    </div>
                </div>
            </div>

            <button type="submit">Get My Credit Score Estimate</button>
        </form>

        <div class="loading" id="loading">
            <div class="loading-spinner"></div>
            <p>Analyzing credit risk...</p>
        </div>

        <div class="error" id="error">
            <p id="errorMessage">An error occurred. Please try again.</p>
        </div>

        <div class="result" id="result">
            <h2>Credit Risk Assessment Results</h2>
            
            <div class="score-container">
                <div class="score-circle">
                    <span id="ficoScore">750</span>
                </div>
                <div class="score-details">
                    <h3><span id="riskLevel">Good</span> Credit Rating</h3>
                    <p class="score-explanation">Your estimated credit score is on a scale of 300-850, where higher scores indicate better creditworthiness.</p>
                </div>
            </div>
            
            <div class="credit-summary">
                <div class="summary-card">
                    <h4>What This Means</h4>
                    <p id="ratingExplanation">A good credit score means you'll likely qualify for most loans at competitive rates.</p>
                </div>
                <div class="summary-card">
                    <h4>Risk Level</h4>
                    <p>Probability of defaulting: <span id="riskProbability">10%</span></p>
                    <p class="help-text">(Lower is better)</p>
                </div>
            </div>

            <div class="score-range-container">
                <h4>Where Your Score Stands</h4>
                <div class="score-range">
                    <div class="range-segment poor">
                        <div class="range-label">Poor</div>
                        <div class="range-value">300-579</div>
                    </div>
                    <div class="range-segment fair">
                        <div class="range-label">Fair</div>
                        <div class="range-value">580-669</div>
                    </div>
                    <div class="range-segment good">
                        <div class="range-label">Good</div>
                        <div class="range-value">670-739</div>
                    </div>
                    <div class="range-segment excellent">
                        <div class="range-label">Excellent</div>
                        <div class="range-value">740-850</div>
                    </div>
                </div>
                <div id="score-pointer"></div>
            </div>
            
            <!-- Credit Factors Explanation Section -->
            <div class="credit-factors" id="creditFactors">
                <h3>What Makes Up Your Credit Score</h3>
                <p class="help-text">Understanding these factors can help you improve your credit over time:</p>
                <div class="loading-factors" id="factorsLoading">
                    <div class="spinner"></div>
                    <p>Loading credit factors...</p>
                </div>
                <div class="factor-container" id="factorContainer">
                    <!-- Factors will be loaded here -->
                </div>
            </div>
            
            <!-- New Loan Approval Section -->
            <div class="loan-approval-section">
                <h3>Loan Approval Probabilities</h3>
                <p class="help-text">Based on your credit profile, here's how likely you are to be approved for different loan types:</p>
                
                <div class="loan-cards-container" id="loanCardsContainer">
                    <!-- Loan cards will be added here dynamically -->
                </div>
                
                <div class="loan-legend">
                    <div class="legend-item">
                        <span class="legend-color high-approval"></span>
                        <span>High Approval Chance</span>
                    </div>
                    <div class="legend-item">
                        <span class="legend-color medium-approval"></span>
                        <span>Medium Approval Chance</span>
                    </div>
                    <div class="legend-item">
                        <span class="legend-color low-approval"></span>
                        <span>Low Approval Chance</span>
                    </div>
                </div>
            </div>
            
            <div class="factors-container" id="riskFactors">
                <h3>Key Factors Affecting Your Score</h3>
                <p class="help-text">These factors have the most impact on your credit assessment:</p>
                <ul id="factorsList">
                </ul>
                <div id="improvementTips" class="improvement-tips">
                    <h4>How to Improve Your Score</h4>
                    <ul id="tipsList">
                    </ul>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Fetch credit factor explanations on page load
        document.addEventListener('DOMContentLoaded', function() {
            // Initialize any tooltips
            document.querySelectorAll('.info-tooltip').forEach(tooltip => {
                tooltip.addEventListener('click', (e) => {
                    e.stopPropagation();
                    tooltip.querySelector('.tooltip-content').style.display = 'block';
                });
            });
            
            // Close tooltips when clicking elsewhere
            document.addEventListener('click', () => {
                document.querySelectorAll('.tooltip-content').forEach(content => {
                    content.style.display = 'none';
                });
            });
            
            // Load field descriptions
            fetch('/field-info')
                .then(response => response.json())
                .then(data => {
                    // Apply field descriptions to form elements
                    Object.entries(data).forEach(([key, info]) => {
                        const element = document.getElementById(key);
                        if (element) {
                            // Apply any special formatting or options for the field
                            if (info.type === 'select' && info.options) {
                                // Clear and rebuild the select options
                                element.innerHTML = '';
                                info.options.forEach(option => {
                                    const optElement = document.createElement('option');
                                    optElement.value = option.value;
                                    optElement.textContent = option.label;
                                    element.appendChild(optElement);
                                });
                            }
                            
                            // Add help text if available
                            if (info.help_text) {
                                const helpElem = document.createElement('span');
                                helpElem.className = 'help-text';
                                helpElem.textContent = info.help_text;
                                element.parentNode.appendChild(helpElem);
                            }
                        }
                    });
                })
                .catch(error => console.error('Error loading field descriptions:', error));
            
            // Load credit factor explanations (will be displayed after form submission)
            fetch('/credit-factor-explanations')
                .then(response => response.json())
                .then(factors => {
                    // Store factors for later use when displaying results
                    window.creditFactors = factors;
                })
                .catch(error => console.error('Error loading credit factors:', error));
        });

        document.getElementById('creditForm').addEventListener('submit', function(e) {
            e.preventDefault();
            
            // Show loading
            document.getElementById('loading').style.display = 'block';
            document.getElementById('result').style.display = 'none';
            document.getElementById('error').style.display = 'none';
            
            // Collect form data
            const formData = {
                LIMIT_BAL: parseFloat(document.getElementById('LIMIT_BAL').value),
                SEX: parseInt(document.getElementById('SEX').value),
                EDUCATION: parseInt(document.getElementById('EDUCATION').value),
                MARRIAGE: parseInt(document.getElementById('MARRIAGE').value),
                AGE: parseInt(document.getElementById('AGE').value),
                PAY_0: parseInt(document.getElementById('PAY_0').value),
                PAY_2: parseInt(document.getElementById('PAY_2').value),
                PAY_3: parseInt(document.getElementById('PAY_3').value),
                PAY_4: parseInt(document.getElementById('PAY_4').value),
                PAY_5: parseInt(document.getElementById('PAY_5').value),
                PAY_6: parseInt(document.getElementById('PAY_6').value),
                BILL_AMT1: parseFloat(document.getElementById('BILL_AMT1').value),
                BILL_AMT2: parseFloat(document.getElementById('BILL_AMT2').value),
                BILL_AMT3: parseFloat(document.getElementById('BILL_AMT3').value),
                BILL_AMT4: parseFloat(document.getElementById('BILL_AMT4').value),
                BILL_AMT5: parseFloat(document.getElementById('BILL_AMT5').value),
                BILL_AMT6: parseFloat(document.getElementById('BILL_AMT6').value),
                PAY_AMT1: parseFloat(document.getElementById('PAY_AMT1').value),
                PAY_AMT2: parseFloat(document.getElementById('PAY_AMT2').value),
                PAY_AMT3: parseFloat(document.getElementById('PAY_AMT3').value),
                PAY_AMT4: parseFloat(document.getElementById('PAY_AMT4').value),
                PAY_AMT5: parseFloat(document.getElementById('PAY_AMT5').value),
                PAY_AMT6: parseFloat(document.getElementById('PAY_AMT6').value)
            };
            
            // Add form validation and show any warnings
            let isFormValid = true;
            const billAmounts = [
                formData.BILL_AMT1, formData.BILL_AMT2, formData.BILL_AMT3,
                formData.BILL_AMT4, formData.BILL_AMT5, formData.BILL_AMT6
            ];
            
            const payAmounts = [
                formData.PAY_AMT1, formData.PAY_AMT2, formData.PAY_AMT3,
                formData.PAY_AMT4, formData.PAY_AMT5, formData.PAY_AMT6
            ];
            
            // Check if payment amounts are greater than bill amounts
            for (let i = 0; i < 6; i++) {
                if (payAmounts[i] > billAmounts[i]) {
                    const warningElem = document.createElement('div');
                    warningElem.className = 'warning-message';
                    warningElem.textContent = 'Note: Some payment amounts exceed bill amounts. This is unusual but allowed.';
                    
                    const formElement = document.getElementById('creditForm');
                    formElement.insertBefore(warningElem, formElement.querySelector('button'));
                    
                    setTimeout(() => {
                        warningElem.remove();
                    }, 5000);
                    
                    break;
                }
            }
            
            // Send data to API
            fetch('/predict', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify(formData)
            })
            .then(response => {
                if (!response.ok) {
                    throw new Error('Network response was not ok');
                }
                return response.json();
            })
            .then(data => {
                // Hide loading
                document.getElementById('loading').style.display = 'none';
                
                // Update result
                const resultDiv = document.getElementById('result');
                document.getElementById('ficoScore').textContent = data.fico_score;
                document.getElementById('riskLevel').textContent = data.risk_label;
                document.getElementById('riskProbability').textContent = `${(data.risk_probability * 100).toFixed(2)}%`;
                
                // Set risk color based on FICO score categories
                resultDiv.className = 'result';
                
                // Update score circle color based on score
                const scoreCircle = document.querySelector('.score-circle');
                if (data.risk_label === 'Poor') {
                    resultDiv.classList.add('risk-high');
                    scoreCircle.style.background = 'linear-gradient(135deg, #e74c3c, #c0392b)';
                } else if (data.risk_label === 'Fair') {
                    resultDiv.classList.add('risk-medium');
                    scoreCircle.style.background = 'linear-gradient(135deg, #f39c12, #d35400)';
                } else if (data.risk_label === 'Good') {
                    resultDiv.classList.add('risk-medium');
                    scoreCircle.style.background = 'linear-gradient(135deg, #3498db, #2980b9)';
                } else {
                    resultDiv.classList.add('risk-low');
                    scoreCircle.style.background = 'linear-gradient(135deg, #2ecc71, #27ae60)';
                }
                
                // Update rating explanation
                const ratingExplanation = document.getElementById('ratingExplanation');
                if (data.risk_label === 'Poor') {
                    ratingExplanation.textContent = "You may face difficulty getting approved for credit cards and loans. If approved, you'll likely pay higher interest rates.";
                } else if (data.risk_label === 'Fair') {
                    ratingExplanation.textContent = "You'll likely qualify for most credit but may not get the best interest rates. Some lenders may require additional documentation.";
                } else if (data.risk_label === 'Good') {
                    ratingExplanation.textContent = "You'll likely qualify for most loans at competitive rates, though not necessarily the lowest available.";
                } else {
                    ratingExplanation.textContent = "You'll qualify for the best interest rates and credit offers. Lenders view you as a very low risk.";
                }
                
                // Position the score pointer
                const ficoRange = 850 - 300; // Total FICO range
                const position = ((data.fico_score - 300) / ficoRange) * 100;
                document.getElementById('score-pointer').style.marginLeft = `calc(${position}% - 10px)`;
                
                // Update risk factors
                const factorsList = document.getElementById('factorsList');
                factorsList.innerHTML = '';
                
                if (data.risk_details && data.risk_details.top_factors) {
                    const factors = data.risk_details.top_factors;
                    
                    // Clear any existing tips
                    const tipsList = document.getElementById('tipsList');
                    tipsList.innerHTML = '';
                    
                    if (factors.message) {
                        // No specific factors
                        const li = document.createElement('li');
                        li.textContent = factors.message;
                        factorsList.appendChild(li);
                        
                        // Add a generic tip
                        const tip = document.createElement('li');
                        tip.textContent = "Continue maintaining your good credit habits";
                        tipsList.appendChild(tip);
                    } else {
                        // List specific factors with clear explanations
                        let hasTips = false;
                        
                        if (factors.payment_history) {
                            const li = document.createElement('li');
                            const impact = factors.impact === "high" || factors.impact === "very high" ? "factor-high" : "factor-medium";
                            li.innerHTML = `<strong>Payment History:</strong> ${factors.payment_history} <span class="factor-badge ${impact}">Important Factor</span>`;
                            factorsList.appendChild(li);
                            
                            // Add related tip
                            const tip = document.createElement('li');
                            tip.textContent = "Make all your payments on time. Set up automatic payments or payment reminders to avoid missing due dates.";
                            tipsList.appendChild(tip);
                            hasTips = true;
                        }
                        
                        if (factors.credit_utilization) {
                            const li = document.createElement('li');
                            const impact = factors.impact === "high" || factors.impact === "very high" ? "factor-high" : "factor-medium";
                            li.innerHTML = `<strong>Credit Card Usage:</strong> ${factors.credit_utilization} <span class="factor-badge ${impact}">Important Factor</span>`;
                            factorsList.appendChild(li);
                            
                            // Add related tip
                            const tip = document.createElement('li');
                            tip.textContent = "Try to use less than 30% of your available credit limit. Consider paying down balances or requesting credit line increases.";
                            tipsList.appendChild(tip);
                            hasTips = true;
                        }
                        
                        if (factors.minimum_payments) {
                            const li = document.createElement('li');
                            li.innerHTML = `<strong>Payment Patterns:</strong> ${factors.minimum_payments} <span class="factor-badge factor-medium">Moderate Factor</span>`;
                            factorsList.appendChild(li);
                            
                            // Add related tip
                            const tip = document.createElement('li');
                            tip.textContent = "Pay more than the minimum payment whenever possible to reduce your balance faster and show responsible credit management.";
                            tipsList.appendChild(tip);
                            hasTips = true;
                        }
                        
                        if (factors.recent_credit_issues) {
                            const li = document.createElement('li');
                            li.innerHTML = `<strong>Recent Credit Activity:</strong> ${factors.recent_credit_issues} <span class="factor-badge factor-high">Important Factor</span>`;
                            factorsList.appendChild(li);
                            
                            // Add related tip
                            const tip = document.createElement('li');
                            tip.textContent = "Focus on maintaining positive payment behavior going forward. The impact of negative items decreases over time.";
                            tipsList.appendChild(tip);
                            hasTips = true;
                        }
                        
                        // Add a generic tip if no specific tips were added
                        if (!hasTips) {
                            const tip = document.createElement('li');
                            tip.textContent = "Monitor your credit report regularly and maintain good payment habits.";
                            tipsList.appendChild(tip);
                        }
                        
                        // Add explanation of credit score
                        const explanationLi = document.createElement('li');
                        explanationLi.innerHTML = '<strong>What is a credit score?</strong> A credit score is a number that represents your creditworthiness - how likely you are to repay borrowed money on time.';
                        explanationLi.style.marginTop = '15px';
                        explanationLi.style.paddingTop = '15px';
                        explanationLi.style.borderTop = '1px dashed #ddd';
                        factorsList.appendChild(explanationLi);
                    }
                    
                    // Add factor badges styling
                    const style = document.createElement('style');
                    style.textContent = `
                        .factor-badge {
                            font-size: 12px;
                            padding: 3px 8px;
                            border-radius: 12px;
                            margin-left: 10px;
                            color: white;
                        }
                        .factor-high {
                            background-color: #e74c3c;
                        }
                        .factor-medium {
                            background-color: #f39c12;
                        }
                        .factor-low {
                            background-color: #3498db;
                        }
                    `;
                    document.head.appendChild(style);
                    
                    // Display loan approval probabilities
                    const loanCardsContainer = document.getElementById('loanCardsContainer');
                    loanCardsContainer.innerHTML = ''; // Clear previous content
                    
                    // Define loan type display names
                    const loanTypeNames = {
                        'mortgage': 'Home Mortgage',
                        'auto_loan': 'Auto Loan',
                        'credit_card': 'Credit Card',
                        'personal_loan': 'Personal Loan'
                    };
                    
                    if (data.loan_approval) {
                        Object.entries(data.loan_approval).forEach(([loanType, approvalData]) => {
                            const displayName = loanTypeNames[loanType] || loanType;
                            const probability = approvalData.approval_probability;
                            const rate = approvalData.likely_rate;
                            const approved = approvalData.approved;
                            
                            // Create loan card
                            const card = document.createElement('div');
                            card.className = 'loan-card';
                            
                            // Set appropriate class based on approval chance
                            if (probability >= 75) {
                                card.classList.add('high-chance');
                            } else if (probability >= 50) {
                                card.classList.add('medium-chance');
                            } else {
                                card.classList.add('low-chance');
                            }
                            
                            // Create approval badge
                            const badge = document.createElement('div');
                            badge.className = `loan-badge ${approved ? 'approved-badge' : 'declined-badge'}`;
                            badge.textContent = approved ? 'Likely Approved' : 'May Be Declined';
                            card.appendChild(badge);
                            
                            // Add loan type heading
                            const heading = document.createElement('h4');
                            heading.textContent = displayName;
                            card.appendChild(heading);
                            
                            // Add approval probability
                            const probabilityElem = document.createElement('p');
                            let approvalClass = '';
                            if (probability >= 75) {
                                approvalClass = 'approval-high';
                            } else if (probability >= 50) {
                                approvalClass = 'approval-medium';
                            } else {
                                approvalClass = 'approval-low';
                            }
                            
                            probabilityElem.innerHTML = `<span class="approval-label ${approvalClass}">Approval Chance: ${probability}%</span>`;
                            card.appendChild(probabilityElem);
                            
                            // Add likely interest rate
                            const rateElem = document.createElement('p');
                            rateElem.innerHTML = `<strong>Likely Interest Rate:</strong> <span>${rate}</span>`;
                            card.appendChild(rateElem);
                            
                            // Add card to container
                            loanCardsContainer.appendChild(card);
                        });
                    }
                }
                
                // Show result
                resultDiv.style.display = 'block';
                
                // Always fetch fresh credit factors data when showing results
                fetch('/credit-factor-explanations')
                    .then(response => response.json())
                    .then(factors => {
                        // Store factors data
                        window.creditFactors = factors;
                        
                        // Find the factor container
                        const factorContainer = document.getElementById('factorContainer');
                        if (factorContainer) {
                            factorContainer.innerHTML = ''; // Clear previous content
                            
                            // Hide loading indicator
                            const factorsLoading = document.getElementById('factorsLoading');
                            if (factorsLoading) {
                                factorsLoading.style.display = 'none';
                            }
                            
                            // Render each factor card
                            Object.entries(factors).forEach(([key, factor]) => {
                                const factorCard = document.createElement('div');
                                factorCard.className = `factor-card ${key}`;
                                
                                // Create card header with factor name and weight percentage
                                const header = document.createElement('h4');
                                header.innerHTML = `${factor.name} <span class="weight">${Math.round(factor.impact_weight * 100)}%</span>`;
                                factorCard.appendChild(header);
                                
                                // Add description
                                const description = document.createElement('p');
                                description.textContent = factor.description;
                                factorCard.appendChild(description);
                                
                                // Add tips section
                                if (factor.tips && factor.tips.length > 0) {
                                    const tipsSection = document.createElement('div');
                                    tipsSection.className = 'factor-tips';
                                    
                                    const tipsHeader = document.createElement('h5');
                                    tipsHeader.textContent = 'Tips to Improve';
                                    tipsSection.appendChild(tipsHeader);
                                    
                                    const tipsList = document.createElement('ul');
                                    factor.tips.forEach(tip => {
                                        const tipItem = document.createElement('li');
                                        tipItem.textContent = tip;
                                        tipsList.appendChild(tipItem);
                                    });
                                    
                                    tipsSection.appendChild(tipsList);
                                    factorCard.appendChild(tipsSection);
                                }
                                
                                factorContainer.appendChild(factorCard);
                            });
                        } else {
                            console.error('Factor container element not found');
                        }
                    })
                    .catch(error => {
                        console.error('Error fetching credit factors:', error);
                    });
            })
            .catch(error => {
                // Hide loading, show error
                document.getElementById('loading').style.display = 'none';
                const errorDiv = document.getElementById('error');
                document.getElementById('errorMessage').textContent = 'Error: ' + error.message;
                errorDiv.style.display = 'block';
                console.error('Error:', error);
            });
        });
    </script>
</body>
</html>
